= Gene Sim - Prototype 001

== Use cases

=== Managing Scenarios
[plantuml, manage-scenario-diagram, svg]
----
include::diagrams/use_cases/manage_scenarios.puml/[]
----

==== Start Scenario

===== Flow 1 (happy path)

[cols="1a,1a,1a,3a"]
|===
|Preconditions

  . No scenario is running

|Actions

  . user clicks "Start Scenario"
  . UI sends `POST api/scenario` message to server

|Postconditions

  . scenario is running
  . running scenario matches id and number of agents from payload

| Tests

  * /_acceptance/run_simulation_scenarios_test.exs::start/stop scenarios::start scenario
|===

Precondition: no scenario is running
Action: user clicks Start Scenario / UI sends `POST api/scenario` message to server
Expected:

. scenario is running
. running scenario matches id and number of agents from payload

=== Communicating with Sims

==== External Sim
[plantuml, sim-communication-external-diagram, svg]
----
include::diagrams/use_cases/sim_communication_external.puml[]
----

==== Internal sim connector (`UDPConnectionServer`)
[plantuml, sim-communication-connector-diagram, svg]
----
include::diagrams/use_cases/sim_communication_connector.puml[]
----
. Receive Inbound Messages
  .. Route Inbound messages
     ... Handle Scenario Events
     ... Handle Inbound Sensor Data
         .... Handle Inbound Sensor Data (single)
         .... Handle Inbound Sensor Data (batch)
              ..... single agent, single sensor
              ..... single agent, multiple sensors
              ..... multiple agents, single sensor
              ..... multiple agents, multiple sensors

=== Scenario Data Handling
[plantuml, scenario-data-handling-diagram, svg]
----
include::diagrams/use_cases/scenario_data_handling.puml[]
----
